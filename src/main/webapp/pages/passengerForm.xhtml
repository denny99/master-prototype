<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core"
      xmlns:c="http://java.sun.com/jsp/jstl/core"
>

<ui:composition template="/pages/templates/baseTemplate.xhtml">
    <ui:define name="content">
        <h2>Enter Data for Passenger ##{passengerFormBean.currentPassengerIndex + 1}</h2>
        <h:form id="passengerData" styleClass="ice-skin-rime">
            <f:event id="multiFieldValidationEvent"
                     listener="#{passengerFormBean.validateForm}" type="postValidate"/>

            <!-- id number or passport id -->
            <h:panelGroup id="passportContainer" layout="block"
                          styleClass="contentLevelContainer blockArea">
                <div class="lFloat indented inputFieldGroup">
                    <c:choose>
                        <!-- if other country -->
                        <c:when test="#{bookingFormBean.selectedFlight.foreignTravel()}">
                            <!-- passport -->
                            <span class="iceOutTxt masInfoFieldLabel minindented">Passport Number:</span>
                            <h:inputText id="passportNumber"
                                         value="#{passengerFormBean.currentPassenger.passportNumber}" required="true"
                                         requiredMessage="Insert your Passport Number">
                                <f:ajax event="blur" listener="#{passengerFormBean.passportIdListener}" execute="@this"
                                        render="@form"/>
                            </h:inputText>
                        </c:when>
                        <c:otherwise>
                            <!-- id card -->
                            <span class="iceOutTxt masInfoFieldLabel minindented">Id Card Number:</span>
                            <h:inputText id="idCardNumber"
                                         value="#{passengerFormBean.currentPassenger.idCardNumber}" required="true"
                                         requiredMessage="Insert your Id Card Number">
                                <f:ajax event="blur" listener="#{passengerFormBean.passportIdListener}" execute="@this"
                                        render="@form"/>
                            </h:inputText>
                        </c:otherwise>
                    </c:choose>
                </div>

                <div class="clear"/>
            </h:panelGroup>
            <!-- ajax for prefilling data when id exists -->
            <!-- validate numbers if existing check existing data for correctness -->
            <h:panelGroup id="personalDataContainer" layout="block"
                          styleClass="contentLevelContainer blockArea">
                <!-- if number exists show force edit button -->
                <c:if test="#{passengerFormBean.existingUser}">
                    <div class="indented inputFieldGroup">
                        <h:commandButton value="Edit Data"
                                         styleClass="iceCmdBtn btnOption">
                            <f:ajax render="@form" execute="@this" listener="#{passengerFormBean.forceEditListener}"/>
                        </h:commandButton>
                    </div>
                </c:if>
                <!-- Firstname -->
                <div class="lFloat indented inputFieldGroup">
                    <span class="iceOutTxt masInfoFieldLabel minindented">Firstname:</span>
                    <h:inputText readonly="#{passengerFormBean.existingUser and !passengerFormBean.forceEdit}"
                                 value="#{passengerFormBean.currentPassenger.firstName}" required="true"
                                 requiredMessage="Insert your Firstname"/>
                </div>
                <!-- Lastname -->
                <div class="lFloat indented inputFieldGroup">
                    <span class="iceOutTxt masInfoFieldLabel minindented">Lastname:</span>
                    <h:inputText readonly="#{passengerFormBean.existingUser and !passengerFormBean.forceEdit}"
                                 value="#{passengerFormBean.currentPassenger.lastName}" required="true"
                                 requiredMessage="Insert your Lastname"/>
                </div>
                <!-- Birthday with dp + converter -->
                <div class="lFloat indented inputFieldGroup">
                    <span class="iceOutTxt masInfoFieldLabel minindented">Birthdate:</span>
                    <h:inputText readonly="#{passengerFormBean.existingUser and !passengerFormBean.forceEdit}"
                                 value="#{passengerFormBean.currentPassenger.birthDay}" required="true"
                                 requiredMessage="Insert your Birthdate"
                                 converter="de.uni.frankfurt.DateConverter"/>
                </div>
                <div class="clear"/>
            </h:panelGroup>

            <!-- luggage radio -->
            <h:panelGroup id="luggageContainer" layout="block"
                          styleClass="contentLevelContainer blockArea">

                <div class="clear"/>
            </h:panelGroup>
            <h:commandButton value="Continue"
                             action="#{passengerFormBean.next}"
                             styleClass="iceCmdBtn btnOption"/>
            <h:commandButton action="#{passengerFormBean.back}"
                             value="Back"
                             styleClass="iceCmdBtn btnOption"/>
            <h:commandButton value="Cancel"
                             action="/pages/flightOverview"
                             styleClass="iceCmdBtn btnOption"/>
        </h:form>
    </ui:define>
</ui:composition>
</html>